RewriteEngine    On
#RewriteCond %{HTTPS} off
#RewriteCond %{HTTP_HOST} !^127.0.0
#RewriteCond %{REMOTE_HOST} !^127.0.0
#RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

#REST api
RewriteRule ^(.*)/api/(.*)$                                                     $1/api/index.php?rewrite_uri=$2 [QSA]

# yealink

RewriteRule     ^app/provision/(y000000000124.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000070.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000032.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000044.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000052.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000069.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000053.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000056.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000053.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000073.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000107.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000068.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000035.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000067.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000054.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000107.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000108.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000065.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000076.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000066.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000036.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000116.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000028.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000109.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000029.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000096.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000036.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000004.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000116.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000123.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000052.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000065.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000051.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000150.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000068.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000044.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000067.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000095.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000035.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000046.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000066.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000091.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000000.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000058.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000095.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000097.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000070.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000096.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000025.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000074.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000146.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000038.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000146.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000078.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000058.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000005.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000029.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000037.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000054.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000097.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000076.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000095.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000077.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000108.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000025.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000069.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000023.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000045.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000028.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000044.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000109.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000148.cfg)$                                     app/provision/index.php?file=$1 [QSA]
RewriteRule     ^app/provision/(y000000000007.cfg)$                                     app/provision/index.php?file=$1 [QSA]

#RewriteRule     ^app/provision/y(000000000[A-Fa-f0-9]{3})(?:\.xml|\.cfg)?$          app/provision/index.php?file=$1 [QSA]

# $mac or $mac.cfg/xml
RewriteRule     ^.*([A-Fa-f0-9]{12})(?:\.xml|\.cfg)?$                           app/provision/index.php?mac=$1 [QSA]

# $m:a:c or $m:a:c.cfg/xml
RewriteRule     ^.*((?:[A-Fa-f0-9]{2}[:-]){5}[A-Fa-f0-9]{2})(?:\.xml|\.cfg)?$   app/provision/index.php?mac=$1 [QSA]

# kt*-$mac.xml
RewriteRule     ^kt.*?-([A-Fa-f0-9]{12})\.xml$                                  app/provision/index.php?mac=$1 [QSA]

# cfg-$mac.xml
RewriteRule     ^.*cfg([A-Fa-f0-9]{12})\.xml$                                   app/provision/index.php?mac=$1 [QSA]

#Snom m3
RewriteRule     ^m3/settings/([A-Fa-f0-9]{12})(?:\.cfg)?$                       app/provision/index.php?mac=$1 [QSA]

#Grandstream
RewriteRule     ^.*/cfg([A-Fa-f0-9]{12})(?:\.xml|\.cfg)?$                       app/provision/?mac=$1 [QSA]

#Yealink and Polycom
RewriteRule     ^.*/([A-Fa-f0-9]{12})(?:\.xml|\.cfg)?$                          app/provision/index.php?mac=$1 [QSA]

#Polycom
RewriteRule     ^provision/000000000000.cfg$                                    app/provision/?mac=$1&file={$mac}.cfg [QSA]
RewriteRule     ^provision/features.cfg$                                        app/provision/?mac=$1&file=features.cfg [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-sip.cfg$                           app/provision/?mac=$1&file=sip.cfg [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-phone.cfg$                         app/provision/?mac=$1 [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-registration.cfg$                  app/provision/?mac=$1&file={$mac}-registration.cfg [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-site.cfg$                          app/provision/?mac=$1&file=site.cfg [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-web.cfg$                           app/provision/?mac=$1&file=web.cfg [QSA]
RewriteRule     ^provision/([A-Fa-f0-9]{12})-directory.xml$                     app/provision/?mac=$1&file=directory.xml [QSA]

#Escene
RewriteRule     ^.*/([0-9]{1,11})_Extern.xml$                                   app/provision/?ext=$1&file={$mac}_extern.xml [QSA]
RewriteRule     ^.*/([0-9]{1,11})_Phonebook.xml$                                app/provision/?ext=$1&file={$mac}_phonebook.xml [QSA]

#Aastra
RewriteRule     ^provision/aastra.cfg$                                          app/provision/index.php?file=aastra.cfg [QSA]

Options -Indexes
